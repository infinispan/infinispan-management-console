<div class="container-fluid">
  <div class="row header-row">
    <div class="col-sm-12 col-md-12">
      <ol class="breadcrumb">
        <li>
          <a href="#/server-groups" translate>CLUSTERS</a>
        </li>
        <li ng-if="ctrl.serverInstance.serverGroup"><a ui-sref="server-group({serverGroup: ctrl.serverInstance.serverGroup})" ui-sref-opts="{reload:true}">{{ctrl.serverInstance.serverGroup}}</a></li>
        <li class="active"><strong>{{ctrl.serverInstance.address.name}}</strong></li>
      </ol>

      <div class="dropdown pull-right" uib-dropdown>
        <button class="btn btn-default" type="button" id="refresh.button" ng-click="ctrl.refreshStats()">
          <span class="pficon pficon-refresh"></span> <span translate>REFRESH</span>
        </button>
        <button ng-if="ctrl.isDomainMode()" class="btn btn-default dropdown-toggle" type="button" id="dropdown_menu.button"
                uib-dropdown-toggle><span translate>ACTIONS</span><span class="caret"></span>
        </button>
        <ul ng-if="ctrl.isDomainMode()" class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
          <li role="presentation" ng-class="ctrl.serverInstance.isStopped()?'':'disabled'"><a id-generator="dropdown_menu.start" role="menuitem" ng-click="ctrl.createStartModal(ctrl.serverInstance)" translate>START</a></li>
          <li role="presentation" ng-class="ctrl.serverInstance.isRestartRequired()?'':'disabled'"><a id-generator="dropdown_menu.restart" role="menuitem" ng-click="ctrl.createStartModal(ctrl.serverInstance)" translate>RESTART</a></li>
          <li role="presentation" ng-class="ctrl.serverInstance.isReloadRequired()?'':'disabled'"><a id-generator="dropdown_menu.reload" role="menuitem" ng-click="ctrl.createStartModal(ctrl.serverInstance)" translate>RELOAD</a></li>
          <li role="presentation" ng-class="!ctrl.serverInstance.isStopped()?'':'disabled'"><a id-generator="dropdown_menu.stop" role="menuitem" ng-click="ctrl.createStopModal()" translate>STOP</a></li>
          <li role="presentation" ng-class="ctrl.serverInstance.isStopped()?'':'disabled'"><a id-generator="dropdown_menu.remove" role="menuitem" ng-click="ctrl.createRemoveModal()" translate>REMOVE</a></li>
        </ul>
      </div>
      <h1>
        <span class="label" ng-class="{'label-success':ctrl.serverInstance.isRunning(),
                                      'label-warning':ctrl.serverInstance.isRestartRequired() || ctrl.serverInstance.isReloadRequired(),
                                      'label-danger':ctrl.serverInstance.isStopped()}">
          <span ng-if="ctrl.serverInstance.isRunning()" class="pficon-ok"></span>
          <span ng-if="ctrl.serverInstance.isRestartRequired() || ctrl.serverInstance.isReloadRequired()" class="pficon-warning-triangle-o"></span>
          <span ng-if="ctrl.serverInstance.isStopped()" class="pficon-error-circle-o"></span>
          {{ctrl.serverInstance.state.toUpperCase()}}
        </span> {{ctrl.serverInstance.address.name}}
        <span ng-show="ctrl.isCoordinator()">(coordinator) </span><small>IP: {{ctrl.serverInstance.inetAddress}} - {{ctrl.nodeStats['number-of-entries']}} entries</small>
      </h1>
    </div>
  </div>
  <!--div class="cards-pf" style="padding:20px"-->
  <div style="padding-top: 0px" vertilize-container>
    <div class="row row-cards-pf">

      <!-- BEGIN CARD -->
      <div class="col-xs-2 col-sm-2 col-md-2" id-generator="perf">
        <div class="card-pf card-pf-accented ispn-card">
          <div class="card-pf-heading">
            <h2 class="card-pf-title" translate>PERFORMANCE</h2>
          </div>
          <div class="card-pf-body" vertilize>
            <div class="row">
              <div class="col-md-12">
                <table class="col-md-12">
                  <tr>
                    <th>Avg Reads</th>
                    <td id-generator="perf.reads">{{ctrl.nodeStats['average-read-time'] | number}} ms</td>
                  </tr>
                  <tr>
                    <th>Avg Writes</th>
                    <td id-generator="perf.writes">{{ctrl.nodeStats['average-write-time'] | number}} ms</td>
                  </tr>
                  <tr>
                    <th>Avg Removes</th>
                    <td id-generator="perf.remove">{{ctrl.nodeStats['average-remove-time'] | number}} ms</td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- END CARD -->


      <!-- BEGIN CARD -->
      <div class="col-xs-2 col-sm-2 col-md-2" id-generator="caching">
        <div class="card-pf card-pf-accented ispn-card">
          <div class="card-pf-heading">
            <h2 class="card-pf-title" translate>CACHING_ACTIVITY</h2>
          </div>
          <div class="card-pf-body" vertilize>
            <div class="row">
              <div class="col-md-12">
                <table class="col-md-12">
                  <tr>
                    <th>READ Hits</th>
                    <td id-generator="caching.read_hit">{{ctrl.nodeStats['hits'] | number}}</td>
                  </tr>
                  <tr>
                    <th>READ misses</th>
                    <td id-generator="caching.read_miss">{{ctrl.nodeStats['misses'] | number}}</td>
                  </tr>
                  <tr>
                    <th>REMOVE hits</th>
                    <td id-generator="caching.rm_hit">{{ctrl.nodeStats['remove-hits'] | number}}</td>
                  </tr>
                  <tr>
                    <th>REMOVE misses</th>
                    <td id-generator="caching.rm_miss">{{ctrl.nodeStats['remove-misses'] | number}}</td>
                  </tr>
                  <tr>
                    <th>PUTS</th>
                    <td id-generator="caching.put">{{ctrl.nodeStats['stores'] | number}}</td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- END CARD -->

      <div class="col-xs-8 col-sm-8 col-md-8" id-generator="perf_metrics">
        <div class="card-pf card-pf-accented ispn-card">
          <div class="card-pf-heading">
            <h2 class="card-pf-title" translate>PERFORMANCE_METRICS</h2>
          </div>
          <div class="card-pf-body" vertilize>
            <div class="row">
              <div class="col-md-4 memory-usage text-center" ng-show="ctrl.serverInstance.isRunning()">
                <h4>Heap Memory Usage</h4>
                <pf-donut-pct-chart config="ctrl.config"
                    center-label='ctrl.label'
                    data="ctrl.data"
                    chart-height="ctrl.chartHeight"></pf-donut-pct-chart>
              </div>
              <div class="col-md-8" ng-show="false">
                <h4>Node is stopped</h4>
              </div>
              <div class="col-md-6 memory-info">
                <div class="row memory-info">
                  <div class="col-md-12">
                    <h4>Threads</h4>
                  </div>
                  <div class="col-md-12">
                    <div class="row">
                      <div class="col-md-7">
                        <span class="prop">Count</span>
                      </div>
                      <div class="col-md-5">
                        <span id-generator="perf_metrics.thread.count">{{ctrl.threadCount}}</span>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-12">
                    <div class="row">
                      <div class="col-md-7">
                        <span class="prop">Peak</span>
                      </div>
                      <div class="col-md-5">
                        <span id-generator="perf_metrics.thread.peak">{{ctrl.threadPeakCount}}</span>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-12">
                    <div class="row">
                      <div class="col-md-7">
                        <span class="prop">Daemon</span>
                      </div>
                      <div class="col-md-5">
                        <span id-generator="perf_metrics.thread.daemon">{{ctrl.threadDaemonCount}}</span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row memory-info">
                  <div class="col-md-12">
                    <h4>Direct Buffers</h4>
                  </div>
                  <div class="col-md-12">
                    <div class="row">
                      <div class="col-md-7">
                        <span class="prop">Count</span>
                      </div>
                      <div class="col-md-5">
                        <span id-generator="perf_metrics.direct_buff.count">{{ctrl.directBufferPoolCount}}</span>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-12">
                    <div class="row">
                      <div class="col-md-7">
                        <span class="prop">Memory</span>
                      </div>
                      <div class="col-md-5">
                        <span id-generator="perf_metrics.direct_buff.mem">{{ctrl.convertBytes(ctrl.directBufferPoolMemoryUsed)}}</span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-12">
                    <h4>Mapped Buffers</h4>
                  </div>
                  <div class="col-md-12">
                    <div class="row">
                      <div class="col-md-7">
                        <span class="prop">Count</span>
                      </div>
                      <div class="col-md-5">
                        <span id-generator="perf_metrics.mapped_buff.count">{{ctrl.mappedBufferPoolCount}}</span>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-12">
                    <div class="row">
                      <div class="col-md-7">
                        <span class="prop">Memory</span>
                      </div>
                      <div class="col-md-5">
                        <span id-generator="perf_metrics.mapped_buff.mem">{{ctrl.convertBytes(ctrl.mappedBufferPoolMemoryUsed)}}</span>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>
            <div class="row">
              <div class="col-md-4 memory-usage text-center" ng-show="ctrl.serverInstance.isRunning()">
                <h4>Off-Heap Memory Usage</h4>
              </div>

              <div class="col-md-6 memory-info">
                <div class="row memory-info">
                  <div class="col-md-12">
                    <h4>Memory</h4>
                  </div>
                  <div class="col-md-12">
                    <div class="row">
                      <div class="col-md-7">
                        <span class="prop">Used</span>
                      </div>
                      <div class="col-md-5">
                        <span id-generator="perf_metrics.thread.count">{{ctrl.convertBytes(ctrl.nodeStats['off-heap-memory-used'])}}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

